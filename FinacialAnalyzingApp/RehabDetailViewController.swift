//
//  RehabDetailViewController.swift
//  FinacialAnalyzingApp
//
//  Created by wwww on 2017-08-04.
//
//

import UIKit

class RehabDetailViewController: UIViewController, UITableViewDelegate, UITableViewDataSource {
    
    @IBOutlet weak var tableView: UITableView!
    @IBOutlet weak var totalView: UIView!
    @IBOutlet weak var fieldTItle_lb: UILabel!
    @IBOutlet weak var totalValue_lb: UILabel!
    @IBOutlet weak var bestTotal_lb: UILabel!
    @IBOutlet weak var bestLabor_lb: UILabel!
    @IBOutlet weak var bestMaterial_lb: UILabel!
    @IBOutlet weak var lowTotal_lb: UILabel!
    @IBOutlet weak var lowLabor_lb: UILabel!
    @IBOutlet weak var lowMaterial_lb: UILabel!
    @IBOutlet weak var highTotal_lb: UILabel!
    @IBOutlet weak var highLabor_lb: UILabel!
    @IBOutlet weak var highMaterial_lb: UILabel!
    @IBOutlet weak var showTotalView_btn: UIButton!
    @IBOutlet weak var totalViewYConstraint: NSLayoutConstraint!
    @IBOutlet weak var savetoPDF_btn: UIButton!
    
    var totalViewShowed : Bool = false

    override func viewDidLoad() {
        super.viewDidLoad()
        NotificationCenter.default.addObserver(self, selector: #selector(keyboardWillShow), name:UIResponder.keyboardDidShowNotification, object: nil);
        NotificationCenter.default.addObserver(self, selector: #selector(keyboardWillHide), name: UIResponder.keyboardWillHideNotification, object: nil)
        
        let swipeUp = UISwipeGestureRecognizer(target: self, action: #selector(swipeUpAct))
        swipeUp.direction = .up
        totalView.addGestureRecognizer(swipeUp)
        
        let swipeDown = UISwipeGestureRecognizer(target: self, action: #selector(swipeDownAct))
        swipeDown.direction = .down
        totalView.addGestureRecognizer(swipeDown)
        
        let nib = UINib(nibName: "RehabDetailBaseTableViewCell", bundle: nil)
        tableView.register(nib, forCellReuseIdentifier: "DetailCell")
        
        initFrames()
        
        // Do any additional setup after loading the view.
    }
    override func viewWillAppear(_ animated: Bool) {
        
    }
    override func didReceiveMemoryWarning() {
        super.didReceiveMemoryWarning()
        // Dispose of any resources that can be recreated.
    }
    
    @objc func keyboardWillShow(notification: NSNotification) {
        if let keyboardSize = (notification.userInfo?[UIResponder.keyboardFrameEndUserInfoKey] as? NSValue)?.cgRectValue {
            let contentInsets = UIEdgeInsets(top:0.0, left:0.0, bottom:keyboardSize.height - 50, right:0.0)
            tableView.contentInset = contentInsets
        }
    }
    
    @objc func keyboardWillHide(notification: NSNotification) {
        tableView.contentInset = UIEdgeInsets(top: 0,
                                               left: 0,
                                               bottom: 0,
                                               right: 0)
    }
    
    //MARK: Init Functions
    
    func initFrames() {
        totalView.layer.cornerRadius = 10
        savetoPDF_btn.layer.cornerRadius = 5
    }
    
    //MARK: My Setting Functions
    
    public func setTotalTitleAndValue() {
        let totalTitle = DataManagement.sharedInstance.getFieldTitle(index: DataManagement.sharedInstance.fieldIndex)
        fieldTItle_lb.text = "\(totalTitle) Total"
        
        totalValue_lb.text = "$ \(String(describing: DataManagement.sharedInstance.totalPerField!))"
        
        let (estTotal, estLab, estMat, lowTotal, lowLab, lowMat, highTotal, highLab, highMat) = DataManagement.sharedInstance.getBestEstimate()
        
        bestTotal_lb.text = "$ \(estTotal)"
        bestLabor_lb.text = "$ \(estLab)"
        bestMaterial_lb.text = "$ \(estMat)"
        
        lowTotal_lb.text = "$ \(lowTotal)"
        lowLabor_lb.text = "$ \(lowLab)"
        lowMaterial_lb.text = "$ \(lowMat)"
        
        highTotal_lb.text = "$ \(highTotal)"
        highLabor_lb.text = "$ \(highLab)"
        highMaterial_lb.text = "$ \(highMat)"
        
    }
    
    func repairStrSortArray(numArray : [Int]) -> [String] {
        var resultArray = [String]()
        
        for num in numArray {
            if num == 1 {
                resultArray.append("Yes")
            } else {
                resultArray.append("No")
            }
        }
        
        return resultArray
        
    }
    
    //MARK: My Event Functions
    
    @objc func swipeUpAct() {
        totalViewShowed = true
        UIView.animate(withDuration: 0.2, delay: 0, options: .curveEaseIn, animations: {
            self.totalViewYConstraint.constant = -15
            self.showTotalView_btn.setImage(UIImage(named: "whitedownArrow.png"), for: .normal)
            self.view.layoutIfNeeded()
        }, completion: nil)
    }
    
    @objc func swipeDownAct() {
        totalViewShowed = false
        UIView.animate(withDuration: 0.2, delay: 0, options: .curveEaseIn, animations: {
            
            self.showTotalView_btn.setImage(UIImage(named: "whiteupArrow.png"), for: .normal)
            self.totalViewYConstraint.constant = -140
            self.view.layoutIfNeeded()
        }, completion: nil)
    }
    
    @IBAction func logoAct(_ sender: Any) {
        if #available(iOS 10.0, *) {
            UIApplication.shared.open(URL(string: "https://www.chicagocashflow.com")!, options: [:], completionHandler: nil)
        } else {
            // Fallback on earlier versions
        }
    }
    @IBAction func showTotalViewAct(_ sender: Any) {
        if !totalViewShowed {
            totalViewShowed = true
            
            UIView.animate(withDuration: 0.2, delay: 0, options: .curveEaseIn, animations: {
                self.totalViewYConstraint.constant = -15
                self.showTotalView_btn.setImage(UIImage(named: "whitedownArrow.png"), for: .normal)
                self.view.layoutIfNeeded()
            }, completion: nil)
        } else {
            totalViewShowed = false
            UIView.animate(withDuration: 0.2, delay: 0, options: .curveEaseIn, animations: {
                
                self.showTotalView_btn.setImage(UIImage(named: "whiteupArrow.png"), for: .normal)
                self.totalViewYConstraint.constant = -120
                self.view.layoutIfNeeded()
            }, completion: nil)
        }
    }
    
    @IBAction func savetoPDF(_ sender: Any) {
        
        let exteriorDic = DataManagement.sharedInstance.rehabValueDic["Exterior"] as! [String : AnyObject]
        let exteriorQuantityArray = exteriorDic["quentityValue"] as! [String]
        let exteriorRepairNumArray = exteriorDic["selectionMode"] as! [Int]
        let exteriorRepairStrArray = repairStrSortArray(numArray: exteriorRepairNumArray)
        let exteriorTotalArray = exteriorDic["totalValue"] as! [String]
        let exteriorLaborArray = exteriorDic["laborValue"] as! [String]
        let exteriorMaterialArray = exteriorDic["materialValue"] as! [String]
        let exteriorTotal = exteriorDic["fieldTotal"] as! String
        
        let interiorDic = DataManagement.sharedInstance.rehabValueDic["Interior"] as! [String : AnyObject]
        let interiorQuantityArray = interiorDic["quentityValue"] as! [String]
        let interiorRepairNumArray = interiorDic["selectionMode"] as! [Int]
        let interiorRepairStrArray = repairStrSortArray(numArray: interiorRepairNumArray)
        let interiorTotalArray = interiorDic["totalValue"] as! [String]
        let interiorLaborArray = interiorDic["laborValue"] as! [String]
        let interiorMaterialArray = interiorDic["materialValue"] as! [String]
        let interiorTotal = interiorDic["fieldTotal"] as! String
        
        let plumbingDic = DataManagement.sharedInstance.rehabValueDic["Plumbing"] as! [String : AnyObject]
        let plumbingQuantityArray = plumbingDic["quentityValue"] as! [String]
        let plumbingRepairNumArray = plumbingDic["selectionMode"] as! [Int]
        let plumbingRepairStrArray = repairStrSortArray(numArray: plumbingRepairNumArray)
        let plumbingTotalArray = plumbingDic["totalValue"] as! [String]
        let plumbingLaborArray = plumbingDic["laborValue"] as! [String]
        let plumbingMaterialArray = plumbingDic["materialValue"] as! [String]
        let plumbingTotal = plumbingDic["fieldTotal"] as! String
        
        let electricalDic = DataManagement.sharedInstance.rehabValueDic["Electrical"] as! [String : AnyObject]
        let electricalQuantityArray = electricalDic["quentityValue"] as! [String]
        let electricalRepairNumArray = electricalDic["selectionMode"] as! [Int]
        let electricalRepairStrArray = repairStrSortArray(numArray: electricalRepairNumArray)
        let electricalTotalArray = electricalDic["totalValue"] as! [String]
        let electricalLaborArray = electricalDic["laborValue"] as! [String]
        let electricalMaterialArray = electricalDic["materialValue"] as! [String]
        let electricalTotal = electricalDic["fieldTotal"] as! String
        
        let hvacDic = DataManagement.sharedInstance.rehabValueDic["HVAC"] as! [String : AnyObject]
        let hvacQuantityArray = hvacDic["quentityValue"] as! [String]
        let hvacRepairNumArray = hvacDic["selectionMode"] as! [Int]
        let hvacRepairStrArray = repairStrSortArray(numArray: hvacRepairNumArray)
        let hvacTotalArray = hvacDic["totalValue"] as! [String]
        let hvacLaborArray = hvacDic["laborValue"] as! [String]
        let hvacMaterialArray = hvacDic["materialValue"] as! [String]
        let hvacTotal = hvacDic["fieldTotal"] as! String
        
        let generalDic = DataManagement.sharedInstance.rehabValueDic["General In/Exterior"] as! [String : AnyObject]
        let generalQuantityArray = generalDic["quentityValue"] as! [String]
        let generalRepairNumArray = generalDic["selectionMode"] as! [Int]
        let generalRepairStrArray = repairStrSortArray(numArray: generalRepairNumArray)
        let generalTotalArray = generalDic["totalValue"] as! [String]
        let generalLaborArray = generalDic["laborValue"] as! [String]
        let generalMaterialArray = generalDic["materialValue"] as! [String]
        let generalTotal = generalDic["fieldTotal"] as! String
        
        let (estTotSumStr, estLabSumStr, estMatSumStr, lowTotSum, lowLabSum, lowMatSum, highTotSum, highLabSum, highMatSum) = DataManagement.sharedInstance.getBestEstimate()
        
        let html = "<b><u>Sheet Name</u> :- PRINT WITH COST</b><hr><table cellspacing=0 border=1><tr><td style=min-width:50px>Quick & Easy Rehab Estimator</td><td style=min-width:50px></td><td style=min-width:50px></td><td style=min-width:50px></td><td style=min-width:50px>(1,200 sqft house)</td><td style=min-width:50px></td><td style=min-width:50px>Default is REPLACE, mark the REPAIR column if needed</td><td style=min-width:50px></td><td style=min-width:50px></td><td style=min-width:50px></td>        <td style=min-width:50px></td><td style=min-width:50px></td><td style=min-width:50px></td></tr><tr><td style=min-width:50px>Description</td><td style=min-width:50px>General Notes</td><td style=min-width:50px>Condition </td><td style=min-width:50px>Quantity</td><td style=min-width:50px>Units</td><td style=min-width:50px>REPAIR</td><td style=min-width:50px>Cost per Unit Repair </td><td style=min-width:50px>Cost per Unit Replace</td><td style=min-width:50px>Total Cost</td><td style=min-width:50px>Labor Portion of Total Cost</td><td style=min-width:50px>Material Portion of Total Cost</td><td style=min-width:50px>Actual Total Cost</td><td style=min-width:50px>Notes</td></tr><tr><td style=min-width:50px></td><td style=min-width:50px></td><td style=min-width:50px>Good/Ok/Bad</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px></td>        <td style=min-width:50px>Exterior Take Pics of Front/back/sides</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>       <tr>    <td style=min-width:50px>Roof </td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(exteriorQuantityArray[0])</td>        <td style=min-width:50px>Square (100 sqft)</td>        <td style=min-width:50px>\(exteriorRepairStrArray[0])</td>        <td style=min-width:50px>$ 50.00</td>        <td style=min-width:50px>$ 230.00</td>        <td style=min-width:50px>$ \(exteriorTotalArray[0])</td>        <td style=min-width:50px>$ \(exteriorLaborArray[0])</td>        <td style=min-width:50px>$ \(exteriorMaterialArray[0])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Siding </td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(exteriorQuantityArray[1])</td>        <td style=min-width:50px>Square (100 sqft)</td>        <td style=min-width:50px>\(exteriorRepairStrArray[1])</td>        <td style=min-width:50px>$ 50.00</td>        <td style=min-width:50px>$ 230.00</td>        <td style=min-width:50px>$ \(exteriorTotalArray[1])</td>        <td style=min-width:50px>$ \(exteriorLaborArray[1])</td>        <td style=min-width:50px>$ \(exteriorMaterialArray[1])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Brick Tuckpointing</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(exteriorQuantityArray[2])</td>        <td style=min-width:50px>hole House vs. Spot</td>        <td style=min-width:50px>\(exteriorRepairStrArray[2])</td>        <td style=min-width:50px>$ 1000.00</td>        <td style=min-width:50px>$ 4000.00</td>        <td style=min-width:50px>$ \(exteriorTotalArray[2])</td>        <td style=min-width:50px>$ \(exteriorLaborArray[2])</td>        <td style=min-width:50px>$ \(exteriorMaterialArray[2])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Gutters </td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(exteriorQuantityArray[3])</td>        <td style=min-width:50px>Linear ft</td>        <td style=min-width:50px>\(exteriorRepairStrArray[3])</td>        <td style=min-width:50px>$ 1.00</td>        <td style=min-width:50px>$ 4.00</td>        <td style=min-width:50px>$ \(exteriorTotalArray[3])</td>        <td style=min-width:50px>$ \(exteriorLaborArray[3])</td>        <td style=min-width:50px>$ \(exteriorMaterialArray[3])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Soffit</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(exteriorQuantityArray[4])</td>        <td style=min-width:50px>Linear ft</td>        <td style=min-width:50px>\(exteriorRepairStrArray[4])</td>        <td style=min-width:50px>$ 1.00</td>        <td style=min-width:50px>$ 4.00</td>        <td style=min-width:50px>$ \(exteriorTotalArray[4])</td>        <td style=min-width:50px>$ \(exteriorLaborArray[4])</td>        <td style=min-width:50px>$ \(exteriorMaterialArray[4])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Fascia</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(exteriorQuantityArray[5])</td>        <td style=min-width:50px>Linear ft</td>        <td style=min-width:50px>\(exteriorRepairStrArray[5])</td>        <td style=min-width:50px>$ 1.00</td>        <td style=min-width:50px>$ 4.00</td>        <td style=min-width:50px>$ \(exteriorTotalArray[5])</td>        <td style=min-width:50px>$ \(exteriorLaborArray[5])</td>        <td style=min-width:50px>$ \(exteriorMaterialArray[5])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Driveway (Concrete)</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(exteriorQuantityArray[6])</td>        <td style=min-width:50px>Sqft</td>        <td style=min-width:50px>\(exteriorRepairStrArray[6])</td>        <td style=min-width:50px>$ 2.00</td>        <td style=min-width:50px>$ 6.50</td>        <td style=min-width:50px>$ \(exteriorTotalArray[6])</td>        <td style=min-width:50px>$ \(exteriorLaborArray[6])</td>        <td style=min-width:50px>$ \(exteriorMaterialArray[6])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Driveway (Asphalt)</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(exteriorQuantityArray[0])</td>        <td style=min-width:50px>Sqft</td>        <td style=min-width:50px>\(exteriorRepairStrArray[7])</td>        <td style=min-width:50px>$ 1.00</td>        <td style=min-width:50px>$ 3.50</td>        <td style=min-width:50px>$ \(exteriorTotalArray[7])</td>        <td style=min-width:50px>$ \(exteriorLaborArray[7])</td>        <td style=min-width:50px>$ \(exteriorMaterialArray[7])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Concrete Walkways</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(exteriorQuantityArray[8])</td>        <td style=min-width:50px>Sqft</td>        <td style=min-width:50px>\(exteriorRepairStrArray[8])</td>        <td style=min-width:50px>$ 2.00</td>        <td style=min-width:50px>$ 6.50</td>        <td style=min-width:50px>$ \(exteriorTotalArray[8])</td>        <td style=min-width:50px>$ \(exteriorLaborArray[8])</td>        <td style=min-width:50px>$ \(exteriorMaterialArray[8])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Garage (2 Car)</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(exteriorQuantityArray[9])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(exteriorRepairStrArray[9])</td>        <td style=min-width:50px>$ 4000.00</td>        <td style=min-width:50px>$ 13000.00</td>        <td style=min-width:50px>$ \(exteriorTotalArray[9])</td>        <td style=min-width:50px>$ \(exteriorLaborArray[9])</td>        <td style=min-width:50px>$ \(exteriorMaterialArray[9])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Garage (1 Car)</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(exteriorQuantityArray[10])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(exteriorRepairStrArray[10])</td>        <td style=min-width:50px>$ 3000.00</td>        <td style=min-width:50px>$ 9000.00</td>        <td style=min-width:50px>$ \(exteriorTotalArray[10])</td>        <td style=min-width:50px>$ \(exteriorLaborArray[10])</td>        <td style=min-width:50px>$ \(exteriorMaterialArray[10])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Garage Door Opener</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(exteriorQuantityArray[11])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(exteriorRepairStrArray[11])</td>        <td style=min-width:50px>$ 75.00</td>        <td style=min-width:50px>$ 350.00</td>        <td style=min-width:50px>$ \(exteriorTotalArray[11])</td>        <td style=min-width:50px>$ \(exteriorLaborArray[11])</td>        <td style=min-width:50px>$ \(exteriorMaterialArray[11])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Garage Door (1 Car)</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(exteriorQuantityArray[12])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(exteriorRepairStrArray[12])</td>        <td style=min-width:50px>$ 150.00</td>        <td style=min-width:50px>$ 600.00</td>        <td style=min-width:50px>$ \(exteriorTotalArray[12])</td>        <td style=min-width:50px>$ \(exteriorLaborArray[12])</td>        <td style=min-width:50px>$ \(exteriorMaterialArray[12])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>       <td style=min-width:50px>Garage Door (2 Car)</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(exteriorQuantityArray[13])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(exteriorRepairStrArray[13])</td>        <td style=min-width:50px>$ 200.00</td>        <td style=min-width:50px>$ 750.00</td>        <td style=min-width:50px>$ \(exteriorTotalArray[13])</td>        <td style=min-width:50px>$ \(exteriorLaborArray[13])</td>        <td style=min-width:50px>$ \(exteriorMaterialArray[13])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Windows</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(exteriorQuantityArray[14])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(exteriorRepairStrArray[14])</td>        <td style=min-width:50px>$ 75.00</td>        <td style=min-width:50px>$ 275.00</td>        <td style=min-width:50px>$ \(exteriorTotalArray[14])</td>        <td style=min-width:50px>$ \(exteriorLaborArray[14])</td>        <td style=min-width:50px>$ \(exteriorMaterialArray[14])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Basic Landscape & Cleanup</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(exteriorQuantityArray[15])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(exteriorRepairStrArray[15])</td>        <td style=min-width:50px>$ 400.00</td>        <td style=min-width:50px>$ 800.00</td>        <td style=min-width:50px>$ \(exteriorTotalArray[15])</td>        <td style=min-width:50px>$ \(exteriorLaborArray[15])</td>        <td style=min-width:50px>$ \(exteriorMaterialArray[15])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Landscaping (All New) </td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(exteriorQuantityArray[16])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(exteriorRepairStrArray[16])</td>        <td style=min-width:50px>$ 750.00</td>        <td style=min-width:50px>$ 2500.00</td>        <td style=min-width:50px>$ \(exteriorTotalArray[16])</td>        <td style=min-width:50px>$ \(exteriorLaborArray[16])</td>        <td style=min-width:50px>$ \(exteriorMaterialArray[16])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Powerwashing</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(exteriorQuantityArray[17])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(exteriorRepairStrArray[17])</td>        <td style=min-width:50px>$ 200.00</td>        <td style=min-width:50px>$ 500.00</td>        <td style=min-width:50px>$ \(exteriorTotalArray[17])</td>        <td style=min-width:50px>$ \(exteriorLaborArray[17])</td>        <td style=min-width:50px>$ \(exteriorMaterialArray[17])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Other</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(exteriorQuantityArray[18])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(exteriorRepairStrArray[18])</td>        <td style=min-width:50px>$ 100.00</td>        <td style=min-width:50px>$ 100.00</td>        <td style=min-width:50px>$ \(exteriorTotalArray[18])</td>        <td style=min-width:50px>$ \(exteriorLaborArray[18])</td>        <td style=min-width:50px>$ \(exteriorMaterialArray[18])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Exterior Total</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>$ \(exteriorTotal)</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px></td>        <td style=min-width:50px>Interior Take pics of all walls, ceiling, floors, etc</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Demo & Cleanout</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(interiorQuantityArray[0])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(interiorRepairStrArray[0])</td>        <td style=min-width:50px>$ 0.25</td>        <td style=min-width:50px>$ 0.50</td>        <td style=min-width:50px>$ \(interiorTotalArray[0])</td>        <td style=min-width:50px>$ \(interiorLaborArray[0])</td>        <td style=min-width:50px>$ \(interiorMaterialArray[0])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Dumpster (30 cubic yd)</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(interiorQuantityArray[1])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(interiorRepairStrArray[1])</td>        <td style=min-width:50px>$ 360.00</td>        <td style=min-width:50px>$ 540.00</td>        <td style=min-width:50px>$ \(interiorTotalArray[1])</td>        <td style=min-width:50px>$ \(interiorLaborArray[1])</td>        <td style=min-width:50px>$ \(interiorMaterialArray[1])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Mold Or Water Damage </td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(interiorQuantityArray[2])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(interiorRepairStrArray[2])</td>        <td style=min-width:50px>$ 500.00</td>        <td style=min-width:50px>$ 2000.00</td>        <td style=min-width:50px>$ \(interiorTotalArray[2])</td>        <td style=min-width:50px>$ \(interiorLaborArray[2])</td>        <td style=min-width:50px>$ \(interiorMaterialArray[2])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Foundation Repair </td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(interiorQuantityArray[3])</td>        <td style=min-width:50px>Each Crack</td>        <td style=min-width:50px>\(interiorRepairStrArray[3])</td>        <td style=min-width:50px>$ 275.00</td>        <td style=min-width:50px>$ 400.00</td>        <td style=min-width:50px>$ \(interiorTotalArray[3])</td>        <td style=min-width:50px>$ \(interiorLaborArray[3])</td>        <td style=min-width:50px>$ \(interiorMaterialArray[3])</td>        <td style=min-width:50px></td>        <td style=min-width:50px>Cinder Block vs. Poured Concrete</td>        </tr>       <tr>        <td style=min-width:50px>Drywall </td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(interiorQuantityArray[4])</td>        <td style=min-width:50px>Sheet</td>        <td style=min-width:50px>\(interiorRepairStrArray[4])</td>        <td style=min-width:50px>$ 16.00</td>        <td style=min-width:50px>$ 24.00</td>        <td style=min-width:50px>$ \(interiorTotalArray[4])</td>        <td style=min-width:50px>$ \(interiorLaborArray[4])</td>        <td style=min-width:50px>$ \(interiorMaterialArray[4])</td>        <td style=min-width:50px></td>        <td style=min-width:50px>Hang/Tape/Prep for Paint</td>        </tr>        <tr>        <td style=min-width:50px>Painting </td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(interiorQuantityArray[5])</td>        <td style=min-width:50px>Sqft</td>        <td style=min-width:50px>\(interiorRepairStrArray[5])</td>        <td style=min-width:50px>$ 0.75</td>        <td style=min-width:50px>$ 1.50</td>        <td style=min-width:50px>$ \(interiorTotalArray[5])</td>        <td style=min-width:50px>$ \(interiorLaborArray[5])</td>        <td style=min-width:50px>$ \(interiorMaterialArray[5])</td>        <td style=min-width:50px></td>        <td style=min-width:50px>All Walls, Ceiling, Base, Shoe, Trim, Casing</td>        </tr>        <tr>        <td style=min-width:50px>Kitchen Backsplash (Tile)</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(interiorQuantityArray[6])</td>        <td style=min-width:50px>Sqft</td>        <td style=min-width:50px>\(interiorRepairStrArray[6])</td>        <td style=min-width:50px>$ 6.00</td>        <td style=min-width:50px>$ 16.00</td>        <td style=min-width:50px>$ \(interiorTotalArray[6])</td>        <td style=min-width:50px>$ \(interiorLaborArray[6])</td>        <td style=min-width:50px>$ \(interiorMaterialArray[6])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Bathroom Wall (Tile)</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(interiorQuantityArray[7])</td>        <td style=min-width:50px>Sqft</td>        <td style=min-width:50px>\(interiorRepairStrArray[7])</td>        <td style=min-width:50px>$ 4.00</td>        <td style=min-width:50px>$ 6.00</td>        <td style=min-width:50px>$ \(interiorTotalArray[7])</td>        <td style=min-width:50px>$ \(interiorLaborArray[7])</td>        <td style=min-width:50px>$ \(interiorMaterialArray[7])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Flooring (Vinyl)</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(interiorQuantityArray[8])</td>        <td style=min-width:50px>Sqft</td>        <td style=min-width:50px>\(interiorRepairStrArray[8])</td>        <td style=min-width:50px>$ 1.50</td>        <td style=min-width:50px>$ 2.80</td>        <td style=min-width:50px>$ \(interiorTotalArray[8])</td>        <td style=min-width:50px>$ \(interiorLaborArray[8])</td>        <td style=min-width:50px>$ \(interiorMaterialArray[8])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Flooring (Tile)</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(interiorQuantityArray[9])</td>        <td style=min-width:50px>Sqft</td>        <td style=min-width:50px>\(interiorRepairStrArray[9])</td>        <td style=min-width:50px>$ 4.00</td>        <td style=min-width:50px>$ 6.00</td>        <td style=min-width:50px>$ \(interiorTotalArray[9])</td>        <td style=min-width:50px>$ \(interiorLaborArray[9])</td>        <td style=min-width:50px>$ \(interiorMaterialArray[9])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Flooring (Carpet)</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(interiorQuantityArray[10])</td>        <td style=min-width:50px>Sq yd (9 Sqft)</td>        <td style=min-width:50px>\(interiorRepairStrArray[10])</td>        <td style=min-width:50px>$ 4.00</td>        <td style=min-width:50px>$ 12.00</td>        <td style=min-width:50px>$ \(interiorTotalArray[10])</td>        <td style=min-width:50px>$ \(interiorLaborArray[10])</td>        <td style=min-width:50px>$ \(interiorMaterialArray[10])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Flooring (Wood - New)</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(interiorQuantityArray[11])</td>        <td style=min-width:50px>Sqft</td>        <td style=min-width:50px>\(interiorRepairStrArray[11])</td>        <td style=min-width:50px>$ 2.00</td>        <td style=min-width:50px>$ 6.00</td>        <td style=min-width:50px>$ \(interiorTotalArray[11])</td>        <td style=min-width:50px>$ \(interiorLaborArray[11])</td>        <td style=min-width:50px>$ \(interiorMaterialArray[11])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Flooring (Wood - Refinish)</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(interiorQuantityArray[12])</td>        <td style=min-width:50px>Sqft</td>        <td style=min-width:50px>\(interiorRepairStrArray[12])</td>        <td style=min-width:50px>$ 0.50</td>        <td style=min-width:50px>$ 1.30</td>        <td style=min-width:50px>$ \(interiorTotalArray[12])</td>        <td style=min-width:50px>$ \(interiorLaborArray[12])</td>        <td style=min-width:50px>$ \(interiorMaterialArray[12])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Millwork </td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(interiorQuantityArray[13])</td>        <td style=min-width:50px>Linear ft</td>        <td style=min-width:50px>\(interiorRepairStrArray[13])</td>        <td style=min-width:50px>$ 0.75</td>        <td style=min-width:50px>$ 1.50</td>        <td style=min-width:50px>$ \(interiorTotalArray[13])</td>        <td style=min-width:50px>$ \(interiorLaborArray[13])</td>        <td style=min-width:50px>$ \(interiorMaterialArray[13])</td>        <td style=min-width:50px></td>        <td style=min-width:50px>Base, 1/4 Round, Casing, Trim </td>        </tr>        <tr>        <td style=min-width:50px>Interior Doors</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(interiorQuantityArray[14])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(interiorRepairStrArray[14])</td>        <td style=min-width:50px>$ 50.00</td>        <td style=min-width:50px>$ 125.00</td>        <td style=min-width:50px>$ \(interiorTotalArray[14])</td>        <td style=min-width:50px>$ \(interiorLaborArray[14])</td>        <td style=min-width:50px>$ \(interiorMaterialArray[14])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Exterior Doors</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(interiorQuantityArray[15])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(interiorRepairStrArray[15])</td>        <td style=min-width:50px>$ 75.00</td>        <td style=min-width:50px>$ 225.00</td>        <td style=min-width:50px>$ \(interiorTotalArray[15])</td>        <td style=min-width:50px>$ \(interiorLaborArray[15])</td>        <td style=min-width:50px>$ \(interiorMaterialArray[15])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Door Hardware</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(interiorQuantityArray[16])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(interiorRepairStrArray[16])</td>        <td style=min-width:50px>$ 5.00</td>        <td style=min-width:50px>$ 25.00</td>        <td style=min-width:50px>$ \(interiorTotalArray[16])</td>        <td style=min-width:50px>$ \(interiorLaborArray[16])</td>        <td style=min-width:50px>$ \(interiorMaterialArray[16])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Kitchen Cabinets (Flip) </td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(interiorQuantityArray[17])</td>        <td style=min-width:50px>Set</td>        <td style=min-width:50px>\(interiorRepairStrArray[17])</td>        <td style=min-width:50px>$ 575.00</td>        <td style=min-width:50px>$ 2850.00</td>        <td style=min-width:50px>$ \(interiorTotalArray[17])</td>        <td style=min-width:50px>$ \(interiorLaborArray[17])</td>        <td style=min-width:50px>$ \(interiorMaterialArray[17])</td>        <td style=min-width:50px></td>        <td style=min-width:50px>Avg 10' x 10' Kitchen</td>        </tr>        <tr>        <td style=min-width:50px>Kitchen Cabinets (Rental)</td>        <td style=min-width:50px></td>       <td style=min-width:50px></td>        <td style=min-width:50px>\(interiorQuantityArray[18])</td>        <td style=min-width:50px>Set</td>        <td style=min-width:50px>\(interiorRepairStrArray[18])</td>        <td style=min-width:50px>$ 415.00</td>        <td style=min-width:50px>$ 2100.00</td>        <td style=min-width:50px>$ \(interiorTotalArray[18])</td>        <td style=min-width:50px>$ \(interiorLaborArray[18])</td>        <td style=min-width:50px>$ \(interiorMaterialArray[18])</td>        <td style=min-width:50px></td>        <td style=min-width:50px>Avg 10' x 10' Kitchen</td>        </tr>        <tr>        <td style=min-width:50px>Kitchen Countertops, Laminate</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(interiorQuantityArray[19])</td>        <td style=min-width:50px>Linear ft</td>        <td style=min-width:50px>\(interiorRepairStrArray[19])</td>        <td style=min-width:50px>$ 5.00</td>        <td style=min-width:50px>$ 25.00</td>        <td style=min-width:50px>$ \(interiorTotalArray[19])</td>        <td style=min-width:50px>$ \(interiorLaborArray[19])</td>        <td style=min-width:50px>$ \(interiorMaterialArray[19])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <tr>        <td style=min-width:50px>Kitchen Countertops, Granite</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(interiorQuantityArray[20])</td>        <td style=min-width:50px>Sqft</td>        <td style=min-width:50px>\(interiorRepairStrArray[20])</td>        <td style=min-width:50px>$ 7.00</td>        <td style=min-width:50px>$ 35.00</td>        <td style=min-width:50px>$ \(interiorTotalArray[20])</td>        <td style=min-width:50px>$ \(interiorLaborArray[20])</td>        <td style=min-width:50px>$ \(interiorMaterialArray[20])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Kitchen Appliances</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(interiorQuantityArray[21])</td>        <td style=min-width:50px>Set</td>        <td style=min-width:50px>\(interiorRepairStrArray[21])</td>        <td style=min-width:50px>$ 650.00</td>        <td style=min-width:50px>$ 2000.00</td>        <td style=min-width:50px>$ \(interiorTotalArray[21])</td>        <td style=min-width:50px>$ \(interiorLaborArray[21])</td>        <td style=min-width:50px>$ \(interiorMaterialArray[21])</td>        <td style=min-width:50px></td>        <td style=min-width:50px>stove, fridge, dishwasher, microwave</td>        </tr>        <tr>        <td style=min-width:50px>Laundry Appliances </td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(interiorQuantityArray[22])</td>        <td style=min-width:50px>Set</td>        <td style=min-width:50px>\(interiorRepairStrArray[22])</td>        <td style=min-width:50px>$ 250.00</td>        <td style=min-width:50px>$ 900.00</td>        <td style=min-width:50px>$ \(interiorTotalArray[22])</td>        <td style=min-width:50px>$ \(interiorLaborArray[22])</td>        <td style=min-width:50px>$ \(interiorMaterialArray[22])</td>        <td style=min-width:50px></td>        <td style=min-width:50px>washer and dryer</td>        </tr>        <tr>        <td style=min-width:50px>Tub Glazing/Spraying</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(interiorQuantityArray[23])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(interiorRepairStrArray[23])</td>        <td style=min-width:50px>$ 150.00</td>        <td style=min-width:50px>$ 250.00</td>        <td style=min-width:50px>$ \(interiorTotalArray[23])</td>        <td style=min-width:50px>$ \(interiorLaborArray[23])</td>        <td style=min-width:50px>$ \(interiorMaterialArray[23])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Vanities & Tops (30' - 48')</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(interiorQuantityArray[24])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(interiorRepairStrArray[24])</td>        <td style=min-width:50px>$ 200.00</td>        <td style=min-width:50px>$ 350.00</td>        <td style=min-width:50px>$ \(interiorTotalArray[24])</td>        <td style=min-width:50px>$ \(interiorLaborArray[24])</td>        <td style=min-width:50px>$ \(interiorMaterialArray[24])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Other</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(interiorQuantityArray[25])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(interiorRepairStrArray[25])</td>        <td style=min-width:50px>$ 100.00</td>        <td style=min-width:50px>$ 100.00</td>        <td style=min-width:50px>$ \(interiorTotalArray[25])</td>        <td style=min-width:50px>$ \(interiorLaborArray[25])</td>        <td style=min-width:50px>$ \(interiorMaterialArray[25])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Interior Total</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>$ \(interiorTotal)</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px></td>        <td style=min-width:50px>Plumbing Note: Galvanized or Copper Lines?</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Rough Plumbing</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(plumbingQuantityArray[0])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(plumbingRepairStrArray[0])</td>        <td style=min-width:50px>$ 1450.00</td>        <td style=min-width:50px>$ 3250.00</td>        <td style=min-width:50px>$ \(plumbingTotalArray[0])</td>        <td style=min-width:50px>$ \(plumbingLaborArray[0])</td>        <td style=min-width:50px>$ \(plumbingMaterialArray[0])</td>        <td style=min-width:50px></td>        <td style=min-width:50px>Behind the Walls/Underground</td>        </tr>        <tr>        <td style=min-width:50px>Trim Plumbing</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(plumbingQuantityArray[1])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(plumbingRepairStrArray[1])</td>        <td style=min-width:50px>$ 400.00</td>        <td style=min-width:50px>$ 1750.00</td>        <td style=min-width:50px>$ \(plumbingTotalArray[1])</td>        <td style=min-width:50px>$ \(plumbingLaborArray[1])</td>        <td style=min-width:50px>$ \(plumbingMaterialArray[1])</td>        <td style=min-width:50px></td>        <td style=min-width:50px>Faucets, Toilets, Sinks, Tub</td>        </tr>        <tr>        <td style=min-width:50px>Hot Water Heater</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(plumbingQuantityArray[2])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(plumbingRepairStrArray[2])</td>        <td style=min-width:50px>$ 175.00</td>        <td style=min-width:50px>$ 750.00</td>        <td style=min-width:50px>$ \(plumbingTotalArray[2])</td>        <td style=min-width:50px>$ \(plumbingLaborArray[2])</td>        <td style=min-width:50px>$ \(plumbingMaterialArray[2])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Ejector Pump (Sewage Water)</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(plumbingQuantityArray[3])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(plumbingRepairStrArray[3])</td>        <td style=min-width:50px>$ 200.00</td>        <td style=min-width:50px>$ 400.00</td>        <td style=min-width:50px>$ \(plumbingTotalArray[3])</td>        <td style=min-width:50px>$ \(plumbingLaborArray[3])</td>        <td style=min-width:50px>$ \(plumbingMaterialArray[3])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Sump Pump (Fresh Water)</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(plumbingQuantityArray[4])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(plumbingRepairStrArray[4])</td>        <td style=min-width:50px>$ 150.00</td>        <td style=min-width:50px>$ 375.00</td>        <td style=min-width:50px>$ \(plumbingTotalArray[4])</td>        <td style=min-width:50px>$ \(plumbingLaborArray[4])</td>        <td style=min-width:50px>$ \(plumbingMaterialArray[4])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Sink Disposal</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(plumbingQuantityArray[5])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(plumbingRepairStrArray[5])</td>        <td style=min-width:50px>$ 75.00</td>        <td style=min-width:50px>$ 175.00</td>        <td style=min-width:50px>$ \(plumbingTotalArray[5])</td>        <td style=min-width:50px>$ \(plumbingLaborArray[5])</td>        <td style=min-width:50px>$ \(plumbingMaterialArray[5])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Drain Rodding </td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(plumbingQuantityArray[6])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(plumbingRepairStrArray[6])</td>        <td style=min-width:50px>$ 250.00</td>        <td style=min-width:50px>$ 600.00</td>        <td style=min-width:50px>$ \(plumbingTotalArray[6])</td>        <td style=min-width:50px>$ \(plumbingLaborArray[6])</td>        <td style=min-width:50px>$ \(plumbingMaterialArray[6])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Other</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(plumbingQuantityArray[7])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(plumbingRepairStrArray[7])</td>        <td style=min-width:50px>$ 100.00</td>        <td style=min-width:50px>$ 100.00</td>        <td style=min-width:50px>$ \(plumbingTotalArray[7])</td>        <td style=min-width:50px>$ \(plumbingLaborArray[7])</td>        <td style=min-width:50px>$ \(plumbingMaterialArray[7])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Plumbing Total</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(plumbingTotal)</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px></td>        <td style=min-width:50px>Electrical Note: Conduit or BX/Greenfield</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>       <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Rough Electrical</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(electricalQuantityArray[0])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(electricalRepairStrArray[0])</td>        <td style=min-width:50px>$ 1200.00</td>        <td style=min-width:50px>$ 3000.00</td>        <td style=min-width:50px>$ \(electricalTotalArray[0])</td>        <td style=min-width:50px>$ \(electricalLaborArray[0])</td>        <td style=min-width:50px>$ \(electricalMaterialArray[0])</td>        <td style=min-width:50px></td>        <td style=min-width:50px>Behind walls/Underground</td>        </tr>        <tr>        <td style=min-width:50px>Trim Electrical</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(electricalQuantityArray[1])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(electricalRepairStrArray[1])</td>        <td style=min-width:50px>$ 900.00</td>        <td style=min-width:50px>$ 1500.00</td>        <td style=min-width:50px>$ \(electricalTotalArray[1])</td>        <td style=min-width:50px>$ \(electricalLaborArray[1])</td>        <td style=min-width:50px>$ \(electricalMaterialArray[1])</td>        <td style=min-width:50px></td>        <td style=min-width:50px>Light Fixtures,        Fans, Fire/CO Detectors </td>        </tr>        <tr>        <td style=min-width:50px>Interior Service Panel </td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(electricalQuantityArray[2])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(electricalRepairStrArray[2])</td>        <td style=min-width:50px>$ 300.00</td>        <td style=min-width:50px>$ 600.00</td>        <td style=min-width:50px>$ \(electricalTotalArray[2])</td>        <td style=min-width:50px>$ \(electricalLaborArray[2])</td>        <td style=min-width:50px>$ \(electricalMaterialArray[2])</td>        <td style=min-width:50px></td>        <td style=min-width:50px>Circuit Breaker Box</td>        </tr>        <tr>        <td style=min-width:50px>Exterior Service Panel</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(electricalQuantityArray[3])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(electricalRepairStrArray[3])</td>        <td style=min-width:50px>$ 200.00</td>        <td style=min-width:50px>$ 500.00</td>        <td style=min-width:50px>$ \(electricalTotalArray[3])</td>        <td style=min-width:50px>$ \(electricalLaborArray[3])</td>        <td style=min-width:50px>$ \(electricalMaterialArray[3])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Devices (Switches/Outlets)</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(electricalQuantityArray[4])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(electricalRepairStrArray[4])</td>        <td style=min-width:50px>$ 5.00</td>        <td style=min-width:50px>$ 10.00</td>        <td style=min-width:50px>$ \(electricalTotalArray[4])</td>        <td style=min-width:50px>$ \(electricalLaborArray[4])</td>        <td style=min-width:50px>$ \(electricalMaterialArray[4])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Other</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(electricalQuantityArray[5])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(electricalRepairStrArray[5])</td>        <td style=min-width:50px>$ 100.00</td>        <td style=min-width:50px>$ 100.00</td>        <td style=min-width:50px>$ \(electricalTotalArray[5])</td>        <td style=min-width:50px>$ \(electricalLaborArray[5])</td>        <td style=min-width:50px>$ \(electricalMaterialArray[5])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Electrical Total</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>$ \(electricalTotal)</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px></td>        <td style=min-width:50px>HVAC</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>       <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr><tr>        <td style=min-width:50px>Furnace (Heater) </td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(hvacQuantityArray[0])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(hvacRepairStrArray[0])</td>        <td style=min-width:50px>$ 400.00</td>        <td style=min-width:50px>$ 1200.00</td>        <td style=min-width:50px>$ \(hvacTotalArray[0])</td>        <td style=min-width:50px>$ \(hvacLaborArray[0])</td>        <td style=min-width:50px>$ \(hvacMaterialArray[0])</td>        <td style=min-width:50px></td>        <td style=min-width:50px>(80% Eff, 80k BTU)</td>        </tr>        <tr>        <td style=min-width:50px>A/C Package</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(hvacQuantityArray[1])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(hvacRepairStrArray[1])</td>        <td style=min-width:50px>$ 550.00</td>        <td style=min-width:50px>$ 1750.00</td>        <td style=min-width:50px>$ \(hvacTotalArray[1])</td>        <td style=min-width:50px>$ \(hvacLaborArray[1])</td>        <td style=min-width:50px>$ \(hvacMaterialArray[1])</td>        <td style=min-width:50px></td>        <td style=min-width:50px>Condenser, Line Set, A-Coil, 2.5 Ton, 13 seer </td>        </tr>        <tr>        <td style=min-width:50px>A/C Condenser </td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(hvacQuantityArray[2])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(hvacRepairStrArray[2])</td>        <td style=min-width:50px>$ 300.00</td>        <td style=min-width:50px>$ 1100.00</td>        <td style=min-width:50px>$ \(hvacTotalArray[2])</td>        <td style=min-width:50px>$ \(hvacLaborArray[2])</td>        <td style=min-width:50px>$ \(hvacMaterialArray[2])</td>        <td style=min-width:50px></td>        <td style=min-width:50px>2.5 Ton, 13 seer </td>        </tr>        <tr>        <td style=min-width:50px>Humidifier (On Furnace)</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(hvacQuantityArray[3])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(hvacRepairStrArray[3])</td>        <td style=min-width:50px>$ 80.00</td>        <td style=min-width:50px>$ 240.00</td>        <td style=min-width:50px>$ \(hvacTotalArray[3])</td>        <td style=min-width:50px>$ \(hvacLaborArray[3])</td>        <td style=min-width:50px>$ \(hvacMaterialArray[3])</td>        <td style=min-width:50px></td>        <td style=min-width:50px>80% Efficient 100k BTU</td>        </tr>        <tr>        <td style=min-width:50px>Boiler System (Hot Water) </td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(hvacQuantityArray[4])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(hvacRepairStrArray[4])</td>        <td style=min-width:50px>$ 600.00</td>        <td style=min-width:50px>$ 2200.00</td>        <td style=min-width:50px>$ \(hvacTotalArray[4])</td>        <td style=min-width:50px>$ \(hvacLaborArray[4])</td>        <td style=min-width:50px>$ \(hvacMaterialArray[4])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Ductwork (Whole house)</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(hvacQuantityArray[5])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(hvacRepairStrArray[5])</td>        <td style=min-width:50px>$ 400.00</td>        <td style=min-width:50px>$ 1500.00</td>        <td style=min-width:50px>$ \(hvacTotalArray[5])</td>        <td style=min-width:50px>$ \(hvacLaborArray[5])</td>        <td style=min-width:50px>$ \(hvacMaterialArray[5])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Supply/Return Vents</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(hvacQuantityArray[6])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(hvacRepairStrArray[6])</td>        <td style=min-width:50px>$ 5.00</td>        <td style=min-width:50px>$ 12.00</td>        <td style=min-width:50px>$ \(hvacTotalArray[6])</td>        <td style=min-width:50px>$ \(hvacLaborArray[6])</td>        <td style=min-width:50px>$ \(hvacMaterialArray[6])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Other</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(hvacQuantityArray[7])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(hvacRepairStrArray[7])</td>        <td style=min-width:50px>$ 100.00</td>        <td style=min-width:50px>$ 100.00</td>        <td style=min-width:50px>$ \(hvacTotalArray[7])</td>        <td style=min-width:50px>$ \(hvacLaborArray[7])</td>        <td style=min-width:50px>$ \(hvacMaterialArray[7])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>HVAC Total</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>$ \(hvacTotal)</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px></td>        <td style=min-width:50px>General Interior/Exterior</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Labor and Material</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(generalQuantityArray[0])</td>        <td style=min-width:50px>Work Day</td>        <td style=min-width:50px>\(generalRepairStrArray[0])</td>        <td style=min-width:50px>$ 300.00</td>        <td style=min-width:50px>$ 300.00</td>        <td style=min-width:50px>$ \(generalTotalArray[0])</td>        <td style=min-width:50px>$ \(generalLaborArray[0])</td>        <td style=min-width:50px>$ \(generalMaterialArray[0])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Other</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>\(generalQuantityArray[1])</td>        <td style=min-width:50px>Each</td>        <td style=min-width:50px>\(generalRepairStrArray[1])</td>        <td style=min-width:50px>$ 100.00</td>        <td style=min-width:50px>$ 200.00</td>        <td style=min-width:50px>$ \(generalTotalArray[1])</td>        <td style=min-width:50px>$ \(generalLaborArray[1])</td>        <td style=min-width:50px>$ \(generalMaterialArray[1])</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Miscellaneous Total</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>$ \(generalTotal)</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px>Notes:</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>Base Estimate</td>        <td style=min-width:50px></td>        <td style=min-width:50px>$ \(estTotSumStr)</td>        <td style=min-width:50px>\(estLabSumStr)</td>        <td style=min-width:50px>$ \(estMatSumStr)</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px></td>        <td style=min-width:50px></td>       <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>Low Estimate        (-15%)</td>        <td style=min-width:50px></td>        <td style=min-width:50px>$ \(lowTotSum)</td>        <td style=min-width:50px>$ \(lowLabSum)</td>        <td style=min-width:50px>$ \(lowMatSum)</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px>High Estimate        (+15%)</td>        <td style=min-width:50px></td>        <td style=min-width:50px>$ \(highTotSum)</td>        <td style=min-width:50px>$ \(highLabSum)</td>        <td style=min-width:50px>$ \(highMatSum)</td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        <tr>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        <td style=min-width:50px></td>        </tr>        </table>        <hr>"
        
        let fmt = UIMarkupTextPrintFormatter(markupText: html)
        
        // 2. Assign print formatter to UIPrintPageRenderer
        
        let render = UIPrintPageRenderer()
        render.addPrintFormatter(fmt, startingAtPageAt: 0)
        
        // 3. Assign paperRect and printableRect
        
        let page = CGRect(x: 0, y: 0, width: 595.2, height: 841.8) // A4, 72 dpi
        let printable = page.insetBy(dx: 10, dy: 42)
        
        render.setValue(NSValue(cgRect: page), forKey: "paperRect")
        render.setValue(NSValue(cgRect: printable), forKey: "printableRect")
        
        // 4. Create PDF context and draw
        
        let pdfData = NSMutableData()
        UIGraphicsBeginPDFContextToData(pdfData, CGRect.zero, nil)
        
        for i in 0...render.numberOfPages {
            UIGraphicsBeginPDFPage();
            let bounds = UIGraphicsGetPDFContextBounds()
//            bounds = CGRect(x: bounds.origin.x, y: bounds.origin.y + CGFloat(i * 30), width: bounds.size.width, height: bounds.size.height + 500)
            render.drawPage(at: i, in: bounds)
        }
        
        UIGraphicsEndPDFContext();
        
        // 5. Save PDF file
        
        let documentsPath = NSSearchPathForDirectoriesInDomains(.documentDirectory, .userDomainMask, true)[0]
        
        pdfData.write(toFile: "\(documentsPath)/Mastery.pdf", atomically: true)
        
        performSegue(withIdentifier: "PDFSegue", sender: nil)
    }
    
    //MARK: UITableViewDataSource
    
    public func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -> Int {
        let num = DataManagement.sharedInstance.getShowValuesNum()
        return num
    }
    func tableView(_ tableView: UITableView, heightForRowAt indexPath: IndexPath) -> CGFloat {
        return 237
    }
    public func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -> UITableViewCell {
        
        if indexPath.row != DataManagement.sharedInstance.getShowValuesNum() {
            let cell = tableView.dequeueReusableCell(withIdentifier: "DetailCell", for: indexPath) as! RehabDetailBaseTableViewCell
            cell.initWithData(parentVc: self, calModeSubIndexFromParent: indexPath.row)
            return cell
        } else {
            let cell = tableView.dequeueReusableCell(withIdentifier: "fieldTotalCell", for: indexPath)
            cell.textLabel?.text = "\(DataManagement.sharedInstance.getFieldTitle(index: DataManagement.sharedInstance.fieldIndex)) Total"
            cell.detailTextLabel?.text = "$ \(DataManagement.sharedInstance.getSumFieldTotal())"
            
            cell.textLabel?.textColor = UIColor.white
            cell.detailTextLabel?.textColor = UIColor.white
            
            cell.backgroundColor = UIColor(red: 11/255, green: 2/255, blue: 118/255, alpha: 1)
            return cell
        }
    }
    
    /*
    // MARK: - Navigation

    // In a storyboard-based application, you will often want to do a little preparation before navigation
    override func prepare(for segue: UIStoryboardSegue, sender: Any?) {
        // Get the new view controller using segue.destinationViewController.
        // Pass the selected object to the new view controller.
    }
    */

}
